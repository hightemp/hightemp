–ò—Å—Ç–æ—á–Ω–∏–∫: https://habr.com/ru/companies/vk/articles/824484/

# –í—ã–∂–∏–º–∞–µ–º –∏–∑ Go –º–∞–∫—Å–∏–º—É–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Go, —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π –≤—ã–∂–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞. –ù–æ —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É–∂–µ –Ω–µ—á–µ–≥–æ, –∞ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–∞–¥–æ?

–ú–µ–Ω—è –∑–æ–≤—É—Ç –ù–∏–∫–∏—Ç–∞ –ì–∞–ª—É—à–∫–æ. –Ø —Å—Ç–∞—Ä—à–∏–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –æ—Ç–¥–µ–ª–µ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ. –í —Å—Ç–∞—Ç—å–µ –ø–æ–¥–µ–ª—é—Å—å, –∫–∞–∫–∏–µ —Ö–∏—Ç—Ä–æ—Å—Ç–∏ –ø–æ–º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Go –Ω–∞ –ø–æ–ª–Ω—É—é –º–æ—â–Ω–æ—Å—Ç—å.

#### –û —á—ë–º –±—É–¥–µ—Ç —Ä–µ—á—å –≤ —Å—Ç–∞—Ç—å–µ

- –†–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ –ø–∞–º—è—Ç—å, –∞ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ small-size –æ–±—ä–µ–∫—Ç—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –ø–æ–∫–∞–∂—É –ø–∞—Ä—É —Ç—Ä—é–∫–æ–≤ —Å–æ —Å—Ç–µ–∫–æ–º.
    
- –ü–æ–¥–µ–ª—é—Å—å, –∫–∞–∫ —Å–∏–ª—å–Ω–æ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å BCE (Bounds Check Elimination) –∏ –ø–æ—á–µ–º—É –Ω–µ –≤—Å–µ —Ü–∏–∫–ª—ã¬†`for`-`loop`¬†–æ–¥–∏–Ω–∞–∫–æ–≤–æ –ø–æ–ª–µ–∑–Ω—ã.¬†
    
- –†–∞—Å–∫—Ä–æ—é –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–∫—É—â–∏–π –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä Go –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –Ω–∞ –Ω–∞—à –∫–æ–¥.
    
- –ó–∞—Ç—Ä–æ–Ω—É —Ç–∞–∫–∏–µ —Ç–µ–º—ã, –∫–∞–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è¬†`string`¬†->¬†`[]byte`¬†–∏¬†`[]byte`¬†->¬†`string`, –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞¬†`[]string`¬†‚Äî —ç—Ç–æ –≤–∞–∂–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –≤ –Ω–∞—à–∏—Ö –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç—Ä–æ–∫–∏, –∏ —Å —Ç–∏–ø–æ–º¬†`string`¬†—Å–≤—è–∑–∞–Ω–æ –º–Ω–æ–≥–æ –º–∏—Ñ–æ–≤.
    

–í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –º—ã –ø–∏—à–µ–º –∫–æ–¥ –¥–ª—è —á–µ–ª–æ–≤–µ–∫–∞. –ù–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–∂–∏–º–∞—Ç—å –º–∞–∫—Å–∏–º—É–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Ç–æ –æ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –ø—Ä–∏–¥—ë—Ç—Å—è –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –∏ –Ω–∞—á–∞—Ç—å –ø–∏—Å–∞—Ç—å –∫–æ–¥ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞. –Ø –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–ª –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –±—ã –ª—ë–≥–æ–∫ –≤ —á—Ç–µ–Ω–∏–∏, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏.

_–í—Å—ë —Å–∫–∞–∑–∞–Ω–Ω–æ–µ –±—É–¥–µ—Ç –≤–∞–∂–Ω–æ, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã —É–∂–µ –ø–æ–¥—É–º–∞–ª–∏ –Ω–∞–¥ —Ç–µ–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –≤–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –ù–µ—Ç —Å–º—ã—Å–ª–∞ –ø—ã—Ç–∞—Ç—å—Å—è –≤—ã–∏–≥—Ä—ã–≤–∞—Ç—å –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥—ã –∏–ª–∏ –µ–¥–∏–Ω–∏—Ü—ã –º–µ–≥–∞–±–∞–π—Ç, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö._

### –ß—Ç–æ —Ç–∞–∫–æ–µ small-size –æ–±—ä–µ–∫—Ç—ã –≤ Go?

–≠—Ç–æ –æ–±—ä–µ–∫—Ç—ã —Ä–∞–∑–º–µ—Ä–æ–º –Ω–µ –±–æ–ª–µ–µ —á–µ—Ç—ã—Ä—ë—Ö –º–∞—à–∏–Ω–Ω—ã—Ö —Å–ª–æ–≤. –î–ª—è 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º ‚Äî —ç—Ç–æ 32 –±–∞–π—Ç–∞. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Å–∏–ª—å–Ω–æ –æ–Ω–∏ –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–∞–ø–∏—à–µ–º –ø–∞—Ä—É –±–µ–Ω—á–º–∞—Ä–∫–æ–≤.

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å small-size –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä—ë—Ö¬†`int`. –†—è–¥–æ–º —Å –Ω–∏–º –æ–±—ä–µ–∫—Ç, –æ—Ç–ª–∏—á–∞—é—â–∏–π—Å—è –≤—Å–µ–≥–æ –Ω–∞ –æ–¥–∏–Ω¬†`int`. –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Å—Ç—ã–µ ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –¥–≤—É—Ö –ø–æ–ª–µ–π –æ–±—ä–µ–∫—Ç–∞.

```
type SmallObject struct {	a, b, c, d int}type PlainObject struct {	a, b, c, d int	e          int}func sum1(obj SmallObject) int {	return obj.a + obj.d}func sum2(obj PlainObject) int {	return obj.a + obj.d}
```

–ë–µ–Ω—á–º–∞—Ä–∫ –∫ —ç—Ç–æ–º—É –∫–æ–¥—É —Ç–æ–∂–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç.

```
func BenchmarkSmall(b *testing.B) {	var ret int	for i := 0; i < b.N; i++ {		obj := SmallObject{a: i, d: i}		ret = sum1(obj)	}	_ = ret}
```

```
func BenchmarkPlain(b *testing.B) {	var ret int	for i := 0; i < b.N; i++ {		obj := PlainObject{a: i, d: i, e: i}		ret = sum2(obj)	}	_ = ret}
```

–ö–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç –Ω–∞ –º–µ—Å—Ç–µ –∏ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞. –ï—Å–ª–∏ –º—ã –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏–º, —Ç–æ —É–≤–∏–¥–∏–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ small-size –æ–±—ä–µ–∫—Ç–æ–º, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ 2‚Äì2,5 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ.¬†

`BenchmarkSmallObject-8 1000000000 1.037 ns/op 0 B/op 0 allocs/op`

`BenchmarkPlainObject-8 423361981 2.571 ns/op 0 B/op 0 allocs/op`

–≠—Ç–æ –æ—á–µ–Ω—å —Å—Ç—Ä–∞–Ω–Ω–æ: —É –Ω–∞—Å –¥–≤–∞ –ø–æ—á—Ç–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ª–∏—à—å –Ω–∞ –æ–¥–∏–Ω¬†`int`. –Ø –Ω–∞–ø–æ–º–Ω—é, —á—Ç–æ –Ω–∞—à–∞ —Ü–µ–ª—å ‚Äî —ç–∫–æ–Ω–æ–º–∏—è –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥, —Ç–∞–∫ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —Ç—ã—Å—è—á–∏ –∏ –º–∏–ª–ª–∏–æ–Ω—ã —Ä–∞–∑. –ß—Ç–æ–±—ã —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —ç—Ç–æ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞—Å—Å–µ–º–±–ª–µ—Ä. –ú—ã –±—É–¥–µ–º –∫ –Ω–µ–º—É –æ–±—Ä–∞—â–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–π —Å—Ç–∞—Ç—å–∏. –ü–æ–¥–µ–ª—é—Å—å, –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ —ç—Ç–æ –¥–µ–ª–∞—Ç—å —Å–∞–º–∏.

–ï—Å—Ç—å —Ä–µ—Å—É—Ä—Å¬†[Compiler Explorer (godbolt.org)](https://godbolt.org/). –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏–º –±–æ–ª—å—à–µ, —á–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Ä—É—á–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ go tool, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–æ–∂–Ω–æ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –≤–µ—Ä—Å–∏—è–º–∏ Go, —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –ø–æ–¥ –∫–æ—Ç–æ—Ä—É—é –±—É–¥–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏—è.¬†–ù–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–≤–æ–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ godbolt, —Ç–æ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π:

`go tool compile -S main.go > main.s`

–î–∞–≤–∞–π—Ç–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä.

![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/1ff/e21/d9e/1ffe21d9e90de0c5af5fd2f7b774fd8d.png)

–ò–∑ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ –≤–∏–¥–Ω–æ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ small-size –æ–±—ä–µ–∫—Ç–æ–º, ‚Äî —ç—Ç–æ –ø–∞—Ä–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –û—Ç–º–µ—á—É, —á—Ç–æ –∑–¥–µ—Å—å –º—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ–º —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ–º —Å –æ–±—ä–µ–∫—Ç–æ–º, –≥–¥–µ –ª–∏—à—å –Ω–∞ –æ–¥–∏–Ω¬†`int`¬†–±–æ–ª—å—à–µ, –º—ã —Ç—Ä–∞—Ç–∏–º –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞, –∞ –∑–∞—Ç–µ–º –ø–æ —Ö–æ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –µ–≥–æ —á—Ç–µ–Ω–∏–µ.

Small-size –æ–±—ä–µ–∫—Ç—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ —ç–∫–æ–Ω–æ–º—è—Ç –ø–∞–º—è—Ç—å. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥, —Ä–∞–±–æ—Ç–∞—è –Ω–∞–ø—Ä—è–º—É—é —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏ CPU. –ï—Å—Ç—å –æ–¥–Ω–æ –Ω–æ ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å —Ä–µ–¥–∫–∏–π —Å–ª—É—á–∞–π, —Å–ª–æ–∂–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–∞–∫–∏—Ö –º–∏–∫—Ä–æ–æ–±—ä–µ–∫—Ç–∞—Ö.

### –ü–æ—á–µ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã ‚Äî —ç—Ç–æ –∑–ª–æ, –∫–æ–≥–¥–∞ —Ä–µ—á—å –∏–¥—ë—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ Go?

–Ø –ø–æ–ø—ã—Ç–∞—é—Å—å –≤–∞—Å –≤ —ç—Ç–æ–º —É–±–µ–¥–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è—Ö. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –≥–¥–µ –≤—Å–µ–≥–æ –ª–∏—à—å –¥–≤–∞ –º–µ—Ç–æ–¥–∞.¬†

```
type Summer interface {	SumValue(Object) int	SumPointer(*Object) int}
```

–û–¥–∏–Ω –º–µ—Ç–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, –∞ –≤—Ç–æ—Ä–æ–π ‚Äî –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –æ–±—ä–µ–∫—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π ‚Äî –≤—Å–µ–≥–æ –ª–∏—à—å –¥–≤–∞¬†`int`.

```
type Object struct {	A, B int}
```

–ê –µ—â—ë –¥–æ–ø—É—Å—Ç–∏–º, —á—Ç–æ –≤—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è small-size –æ–±—ä–µ–∫—Ç–æ–≤, –±—É–¥—É—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –∑–¥–µ—Å—å. –ö–æ–¥ —Ç–æ–∂–µ –ø—Ä–æ—Å—Ç–æ–π ‚Äî —Å—É–º–º–∞ —ç—Ç–∏—Ö –¥–≤—É—Ö –ø–æ–ª–µ–π.

```
type Sum struct{}func (v Sum) SumValue(obj Object) int {	return obj.A + obj.B}func (p Sum) SumPointer(obj *Object) int {	return obj.A + obj.B}
```

–ó–∞–ø—É—Å—Ç–∏–º –ø—Ä–æ—Å—Ç–æ–π –±–µ–Ω—á–º–∞—Ä–∫.

![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/6f6/76f/059/6f676f0599b5067c24185909048d2991.png)

`BenchmarkSumPointer-8¬† ¬† 101133675¬† ¬† 11.59 ns/op¬† ¬† 16 B/op¬† ¬† 1 allocs/op`

`BenchmarkSumValue-8 ¬† ¬† ¬†609446936¬† ¬† 1.855 ns/op ¬† ¬† 0 B/op¬† ¬† 0 allocs/op`

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —É–≤–∏–¥–∏–º, —á—Ç–æ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é, —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –∞ –µ—â—ë –∞–ª–ª–æ—Ü–∏—Ä—É–µ—Ç —á—Ç–æ-—Ç–æ –≤ heap. –ü—Ä–∏—á–∏–Ω–∞ –≤ escape analysis, —Ç–∞–∫ –∫–∞–∫ –æ–Ω —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É–µ—Ç—Å—è –≤ —ç—Ç–æ–º –º–µ—Å—Ç–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç—ã–º –ø—Ä–∞–≤–∏–ª–æ–º: –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –µ—Å—Ç—å —É –±–æ–ª–µ–µ —á–µ–º –æ–¥–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω—ã, —Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ heap.

–í—ã –≤–æ–∑—Ä–∞–∑–∏—Ç–µ, —á—Ç–æ —Ç–∞–º –Ω–µ –±—ã–ª–æ –Ω–∏–∫–∞–∫–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω. –ò —è –≤–∞—Å —Å–∏–ª—å–Ω–µ–µ –∑–∞–ø—É—Ç–∞—é: –µ—Å–ª–∏ –º—ã –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∏–ø–æ–º –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, —Ç–æ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –Ω–µ –±—É–¥–µ—Ç.

![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/a97/ba7/981/a97ba7981667ef9c1862b23e66c149c8.png)

–ü–æ—á–µ–º—É –ø—Ä–∞–≤–∏–ª–æ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ, –∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ–µ? –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ —ç—Ç–æ–º –ø—Ä–∞–≤–∏–ª–µ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ:¬†

_–ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏–º–µ–µ—Ç –±–æ–ª–µ–µ —á–µ–º –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞, —Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ heap._¬†**_–ò–ª–∏ –µ—Å–ª–∏ –Ω–µ–ª—å–∑—è –¥–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π._**

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ escape analysis –Ω–µ –∑–∞—Ö–æ–¥–∏—Ç –≤ –Ω–∞—à—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –û–Ω –≤–∏–¥–∏—Ç, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –≤—ã–∑–æ–≤. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ—à–∏—Ç—å, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω–∞ heap –∏–ª–∏ –Ω–µ—Ç. –í —Å–ª—É—á–∞–µ —Å —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –¥–∞–ª—å—à–µ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –ê –µ—Å–ª–∏ –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, —Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –æ—Ç—Å—Ä–æ—á–∏—Ç—å –ø—Ä–∏–Ω—è—Ç–∏–µ —ç—Ç–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.

–û—Ç–º–µ—á—É, –∫–æ–≥–¥–∞ –µ—â—ë –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –º–æ–≥—É—Ç –¥–∞–≤–∞—Ç—å –∞–ª–ª–æ–∫–∞—Ü–∏—é. –°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ, —á—Ç–æ –Ω–∞–¥–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å: –ª—é–±–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ–≥–æ —Ç–∏–ø–∞ –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É ‚Äî –≤—Å–µ–≥–¥–∞ –∞–ª–ª–æ–∫–∞—Ü–∏—è, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª:

- —É–∫–∞–∑–∞—Ç–µ–ª–∏ –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É;
    
- `int`,¬†`int32`,¬†`int6`,¬†`uint`,¬†`uint32`,¬†`uint64`¬†‚Äî –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ¬†`int`¬†–¥–æ 65 —Ç—ã—Å—è—á;
    
- –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç—ã–µ —Ç–∏–ø—ã (–ø—É—Å—Ç–æ–π¬†`struct`¬†–∏–ª–∏¬†`struct`¬†—Å –ø–æ–ª–µ–º, —Ä–∞–∑–º–µ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –æ–¥–Ω–æ –º–∞—à–∏–Ω–Ω–æ–µ —Å–ª–æ–≤–æ).
    

–ü–æ—ç—Ç–æ–º—É –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã. –ó–∞–±—É–¥—å—Ç–µ, —á—Ç–æ –æ–Ω–∏ –µ—Å—Ç—å –≤ Go, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–∂–∞—Ç—å –º–∞–∫—Å–∏–º—É–º.

**–ï—Å—Ç—å –µ—â—ë –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω, –∫–æ—Ç–æ—Ä—ã–π —è –≤–∏–∂—É –≤ —Ä–∞–∑–Ω—ã—Ö Go-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö:**¬†–µ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –≤ –æ–¥–Ω–æ–º –ø–∞–∫–µ—Ç–µ. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ ‚Äî —ç—Ç–æ¬†`fileDumper`¬†–∏¬†`dbDumper`. –ö–æ–¥ –ª—ë–≥–∫–∏–π, —Ö–æ—Ä–æ—à–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –∏ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è. –ù–æ –µ—Å—Ç—å —Ä—è–¥ –ø—Ä–æ–±–ª–µ–º.

![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/663/624/21a/66362421a26f75ce4dd8802931ffc451.png)

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å¬†`main`, –≥–¥–µ –º—ã —Å–æ–∑–¥–∞—ë–º –∫–∞–∂–¥—ã–π¬†`Dumper`¬†–∏ –≤—ã–∑—ã–≤–∞–µ–º¬†`makeDump`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/c09/74c/51f/c0974c51f6545c593cfea78b4dbb7fba.png)

–ï—Å–ª–∏ –º—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º —ç—Ç–æ—Ç –∫–æ–¥ –≤ –∞—Å—Å–µ–º–±–ª–µ—Ä, —Ç–æ —É–≤–∏–¥–∏–º —Ç–∞–∫—É—é –∏—Å—Ç–æ—Ä–∏—é, –∫–∞–∫¬†`go:itab`.

![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/3cc/1e3/fef/3cc1e3fefc3b2a9562139cdfeedbadd8.png)

–ù–∞–ø–æ–º–Ω—é, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äî —ç—Ç–æ —Ç–∏–ø, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –¥–≤—É—Ö —Å–ª–æ–≤, –≥–¥–µ –µ—Å—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–∏–ø. –ü—Ä–æ–±–ª–µ–º–∞¬†`go:itab`¬†–≤ —Ç–æ–º, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ ‚Äî –≤—Å–µ–≥–¥–∞ –ø–æ–∏—Å–∫ –ø–æ —Ç–∞–±–ª–∏—Ü–µ. –ê –ø–æ–∫–∞ –º—ã –∏—â–µ–º, –ø–æ–ª–µ–∑–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.

–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é —Å–¥–µ–ª–∞—Ç—å¬†`enum`¬†–∏–∑ —Ç–µ—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –Ω—É–∂–Ω—ã, –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ–≥–æ –ª–∏—à—å –æ–¥–∏–Ω —Ç–∏–ø.

```
type dumpKind int8const (	_ dumpKind = iota	toFile	toDB)type Dumper struct {	kind dumpKind}func (d Dumper) Dump(s string) {	switch d.kind {	case toFile:	// ...	case toDB:		// ...	}}
```

–£ –Ω–∞—Å –Ω–µ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, –∞ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –ø–æ —Å–≤–∏—Ç—á—É –≤—ã–±–µ—Ä–µ–º —Ç—É –∏–ª–∏ –∏–Ω—É—é –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—é.

–ü—Ä–∏ —ç—Ç–æ–º —ç—Ç–æ—Ç –∫–æ–¥ –Ω–µ –¥–∞—ë—Ç –µ—â—ë –∞–ª–ª–æ–∫–∞—Ü–∏–π, –∫–∞–∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–π.

`BenchmarkInterfaceDumper-8 28651759¬† 41.81 ns/op 48 B/op 2 allocs/op`¬†

`BenchmarkStructDumper-8¬† ¬† 164893970 7.111 ns/op 0 B/op 0 allocs/op`

–ù–æ –µ—Å—Ç—å —Ü–µ–Ω–∞ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- –Ω–µ–∫—Ä–∞—Å–∏–≤–æ –∏ —Ç—Ä—É–¥–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å, –µ—Å–ª–∏ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ, –¥–ª—è —á–µ–≥–æ —ç—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ;
    
- —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å.
    

### –ù–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä—é–∫–æ–≤ —Å–æ —Å—Ç–µ–∫–æ–º

–í–∞–∂–Ω—ã–π —Ç–µ–∑–∏—Å:¬†**–≤ Go –æ–±—ä–µ–∫—Ç—ã –¥–æ 64 –ö–± –±—É–¥—É—Ç —Ä–∞–∑–º–µ—â–µ–Ω—ã –Ω–∞ —Å—Ç–µ–∫–µ**.¬†–ü–æ–º–Ω–∏–º –ø—Ä–æ escape analysis, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø–æ —Å–≤–æ–∏–º –ø—Ä–∞–≤–∏–ª–∞–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ heap, –ø–æ—ç—Ç–æ–º—É:

- –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ –¥—Ä—É–≥–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ;
    
- –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏;
    
- –Ω–µ –ø–µ—Ä–µ–¥–∞—ë–º –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã;
    

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –µ—Å—Ç—å –∫–æ–¥, –≥–¥–µ –≤ —Ñ—É–Ω–∫—Ü–∏–∏¬†`foo`¬†–≤—ã–¥–µ–ª—è–µ–º –¥–≤–∞ —Å–ª–∞–π—Å–∞ –ø–æ 64 –ö–±.

```
func foo() {	a := make([]byte, 64*1024)	b := make([]byte, 64*1024)}
```

–ê –≤ —Ñ—É–Ω–∫—Ü–∏–∏¬†`bar`¬†–¥–µ–ª–∞–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ, —Ç–æ–ª—å–∫–æ –Ω–∞ 2 –±–∞–π—Ç–∞ –±–æ–ª—å—à–µ.

```
func bar() {	a := make([]byte, 64*1024+1)	b := make([]byte, 64*1024+1)}
```

–ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫? –ê –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫ –º–æ–∂–µ—Ç –≤—Å—ë.

`BenchmarkFoo-8 1000000000 0.3189 ns/op 0 B/op 0 allocs/op`

`BenchmarkBar-8 73376 16924 ns/op 147456 B/op 2 allocs/op`

–§—É–Ω–∫—Ü–∏—è¬†`foo`¬†–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º¬†`bar`, –∏ –¥–µ–ª–∞–µ—Ç 0 –∞–ª–ª–æ–∫–∞—Ü–∏–π.

_–¢—É—Ç –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ä–µ–º–∞—Ä–∫—É, —á—Ç–æ —á–µ–º –±–æ–ª—å—à–µ –≤—ã –≤—ã–¥–µ–ª—è–µ—Ç–µ –ø–∞–º—è—Ç–∏ –Ω–∞ —Å—Ç–µ–∫–µ, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —Ä–∞–∑–¥—É–≤–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä —Ñ—Ä–µ–π–º–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –∑–Ω–∞—á–∏—Ç, –ø–µ—Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è —Å—Ç–µ–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Ä–æ–∂–µ._

–•–æ—Ä–æ—à–æ, 64 –ö–± –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ —Å—Ç–µ–∫–µ, –Ω–æ —á—Ç–æ, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Å–ª–∞–π—Å—ã –±–æ–ª—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏ —Å—Ç—Ä–æ–≥–æ –Ω–∞ —Å—Ç–µ–∫–µ? –ü—Ä–∏–¥—ë—Ç—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ 64 –ö–± –∏ –∂–æ–Ω–≥–ª–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å–∞–º–∏? –ù–µ—Ç. –í Go –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ö–∞–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω—Å—Ç–∞–Ω—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–π—Å –Ω–∞ –º–µ—Å—Ç–µ, –∑–∞–¥–∞–≤–∞—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É –∫–∞–∫–æ–µ-—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, ‚Äî –∏ —ç—Ç–æ –Ω–µ –¥–∞—Å—Ç –∞–ª–ª–æ–∫–∞—Ü–∏–π.

```
func baz() {	a := []byte{1_000_000: 0}}
```

`BenchmarkBaz-8 3636 302480 ns/op 0 B/op 0 allocs/op`

–õ–∏—á–Ω–æ –¥–ª—è –º–µ–Ω—è —ç—Ç–æ —Å–µ—Ä–∞—è –∑–æ–Ω–∞. –ï—Å—Ç—å¬†[issue](https://github.com/golang/go/issues/27447)¬†–Ω–∞ —ç—Ç—É —Ç–µ–º—É. –° –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, —Ç–∏–∫–µ—Ç—É —É–∂–µ 3,5 –≥–æ–¥–∞ –∏ –Ω–∏—á–µ–≥–æ —Å –Ω–∏–º –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∞ —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≥–æ–≤–æ—Ä—è—Ç –æ —Ç–æ–º, —á—Ç–æ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã.

### –ü–æ–≥–æ–≤–æ—Ä–∏–º –ø—Ä–æ CPU

#### BCE ‚Äî Bounds Check Elimination¬†

Go –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç —Å–µ–±—è –∫–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —è–∑—ã–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞—Å –æ–≥—Ä–∞–¥–∏—Ç—å –æ—Ç –≤—ã—Ö–æ–¥–æ–≤ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—É –º–∞—Å—Å–∏–≤–∞ –∏–ª–∏ —Å–ª–∞–π—Å–∞ —Å –ø–æ–º–æ—â—å—é BCE ‚Äî Bounds Check Elimination. –ù–æ –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —ç—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –µ—Å—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏–∑¬†`[]byte`¬†–ø–æ–ª—É—á–∞–µ—Ç¬†`uint64`¬†(–≤–∑—è—Ç–æ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏).

```
func toUint64(b []byte) uint64 {	return uint64(b[0]) |		uint64(b[1])<<8 |		uint64(b[2])<<16 |		uint64(b[3])<<24 |		uint64(b[4])<<32 |		uint64(b[5])<<40 |		uint64(b[6])<<48 |		uint64(b[7])<<56}
```

–ö–æ–¥ –±–µ—Ä—ë—Ç —ç–ª–µ–º–µ–Ω—Ç –ø–æ –∏–Ω–¥–µ–∫—Å—É –∏ –¥–µ–ª–∞–µ—Ç –¥–≤–µ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏. –ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ. –ù–æ –µ—Å–ª–∏ –º—ã –∑–∞–ø—É—Å—Ç–∏–º –±–µ–Ω—á–º–∞—Ä–∫, —Ç–æ —É–≤–∏–¥–∏–º, —á—Ç–æ —ç—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ü–µ–ª—ã—Ö 3 –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥—ã.

```
func BenchmarkBCE(b *testing.B) {	buf := make([]byte, 8)	var ret uint64	for i := 0; i < b.N; i++ {		ret = toUint64(buf)	}	_ = ret}
```

`BenchmarkBCE-4 342406828 3.361 ns/op`

–§—É–Ω–∫—Ü–∏—è –ø–æ–¥–æ–±–Ω–æ–≥–æ —Ä–æ–¥–∞ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Ç—ã—Å—è—á–∏ –∏ –º–∏–ª–ª–∏–æ–Ω—ã —Ä–∞–∑, –ø–æ—ç—Ç–æ–º—É —Ö–æ—á–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –µ—ë –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ–π.¬†

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É —É—Ö–æ–¥–∏—Ç —Å—Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω—É–∂–Ω–æ —Å–ø—É—Å—Ç–∏—Ç—å—Å—è –≤ –∞—Å—Å–µ–º–±–ª–µ—Ä.

```
main_toUint64_pc91:MOVL    $7, AXMOVQ    AX, CXPCDATA  $1, $1CALL    runtime.panicIndex(SB)main_toUint64_pc104:MOVL    $6, AXMOVQ    AX, CXCALL    runtime.panicIndex(SB)main_toUint64_pc117:MOVL    $5, AXMOVQ    AX, CXNOPCALL    runtime.panicIndex(SB)main_toUint64_pc133:MOVL    $4, AXMOVQ    AX, CXCALL    runtime.panicIndex(SB)main_toUint64_pc146:MOVL    $3, AXMOVQ    AX, CXCALL    runtime.panicIndex(SB)main_toUint64_pc159:MOVL    $2, AXMOVQ    AX, CXCALL    runtime.panicIndex(SB)main_toUint64_pc172:MOVL    $1, AXMOVQ    AX, CXCALL    runtime.panicIndex(SB)main_toUint64_pc185:XORL    AX, AXMOVQ    AX, CXNOPCALL    runtime.panicIndex(SB)XCHGL   AX, AX
```

–ú—ã –≤–∏–¥–∏–º, —á—Ç–æ –∫–∞–∂–¥–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∏–Ω–¥–µ–∫—Å—É –ø–æ —Ñ–∞–∫—Ç—É –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤¬†`if`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—É –º–∞—Å—Å–∏–≤–∞. –ò –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ, –∫–∏–¥–∞–µ–º –ø–∞–Ω–∏–∫—É, –µ—Å–ª–∏ –Ω–µ—Ç, —Ç–æ –¥–µ–ª–∞–µ–º –¥–∂–∞–º–ø –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

–ö–∞–∫ –Ω–∞–º –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫? –ß—Ç–æ, –µ—Å–ª–∏ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –≤ –Ω–∞—à–µ–º —Å–ª–∞–π—Å–µ —É–∂–µ –µ—Å—Ç—å –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤? –í—Å—ë –ø—Ä–æ—Å—Ç–æ ‚Äî¬†**–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Ç—Ä–æ–≥–∞—Ç—å —Å–∞–º—ã–π –¥–∞–ª—å–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç**.

–û—á–µ–≤–∏–¥–Ω–æ (–∫–∞–∫ –¥–ª—è —á–µ–ª–æ–≤–µ–∫–∞, —Ç–∞–∫ –∏ –¥–ª—è Go), —á—Ç–æ –µ—Å–ª–∏ –µ—Å—Ç—å —Å–∞–º—ã–π –¥–∞–ª—å–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–¥ –∏–Ω–¥–µ–∫—Å–æ–º 7), —Ç–æ –µ—Å—Ç—å –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ.¬†–î–æ–±–∞–≤–∏–º –≤—Å–µ–≥–æ –æ–¥–Ω—É —Å—Ç—Ä–æ—á–∫—É –≤ –Ω–∞—à—É –∏—Å—Ö–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é.

```
func toUint64(b []byte) uint64 {	_ = b[7]	// ...}
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏–º —Ç–æ—Ç –∂–µ —Å–∞–º—ã–π –±–µ–Ω—á–º–∞—Ä–∫ –µ—â—ë —Ä–∞–∑ –∏ —É–≤–∏–¥–∏–º —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 2 —Ä–∞–∑–∞.

`BenchmarkBCE-4¬† ¬† 715002706¬† ¬† 1.657 ns/op`

#### –¶–∏–∫–ª—ã

–í Go —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –≤–∏–¥–∞ —Ü–∏–∫–ª–æ–≤:¬†`for`-`loop`¬†–∏¬†`for`-`range`. –Ø –ø–æ–∫–∞–∂—É, —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–ª–∞—Ç–∏—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º¬†`for`-`range`, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ—Ç —Ü–∏–∫–ª –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏. –í—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å–ª–∞–π—Å–∞ –ø—Ä–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ–≥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ.

–¢–µ—Å—Ç –±—É–¥–µ—Ç –ø—Ä–æ—Å—Ç–æ–π. –û–±—ä–µ–∫—Ç —Å –æ–¥–Ω–∏–º –ø–æ–ª–µ–º¬†`int`¬†–∏ –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–±–µ–≥–∞—é—Ç –ø–æ —Å–ª–∞–π—Å—É –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤, —Å—É–º–º–∏—Ä—É—è –∑–Ω–∞—á–µ–Ω–∏–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—è.

```
type Obj struct {	index int}func sumRange(objects []Obj) int {	ret := 0	for _, v := range objects {		ret += v.index	}	return ret}func sumLoop(objects []Obj) int {	ret := 0	for i := 0; i < len(objects); i++ {		ret += objects[i].index	}	return ret}
```

–ï—Å–ª–∏ –º—ã –∑–∞–ø—É—Å—Ç–∏–º –±–µ–Ω—á–º–∞—Ä–∫ (–æ–Ω —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π, –ø–æ—ç—Ç–æ–º—É –∫–æ–¥ –Ω–µ –ø—Ä–∏–≤–æ–∂—É), —Ç–æ —É–≤–∏–¥–∏–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—ã—á–Ω—ã–π, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π¬†`for`-`loop`¬†–ø–æ –∏–Ω–¥–µ–∫—Å—É, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 4 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º¬†`for`-`range`. –ß–µ–º –∂–∏—Ä–Ω–µ–µ –æ–±—ä–µ–∫—Ç –≤–Ω—É—Ç—Ä–∏ —Å–ª–∞–π—Å–∞, —Ç–µ–º —ç—Ç–∞ —Ä–∞–∑–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –±–æ–ª—å—à–µ.

`BenchmarkForRange-4 ¬† 443161 2371 ns/op`

`BenchmarkForLoop-4 ¬† 1863501 ¬† 641.7 ns/op`

#### –ü—Ä–æ —á—Ç–æ –µ—â—ë –≤–∞–∂–Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å?

- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ –≤–µ–∫—Ç–æ—Ä–∏–∑—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–∏—Å–∞—Ç—å –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ). –ö–æ–¥ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –ø—Ä–æ —Ü–∏–∫–ª—ã –ø–æ —Ñ–∞–∫—Ç—É –¥–æ–ª–∂–µ–Ω —Ö–æ—Ä–æ—à–æ –ø–æ–¥–¥–∞–≤–∞—Ç—å—Å—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –Ω–æ —É–≤—ã, Go —Å–µ–π—á–∞—Å —ç—Ç–æ –Ω–µ —É–º–µ–µ—Ç. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, —Ç–æ –ø—Ä–∏–¥—ë—Ç—Å—è –ø–∏—Å–∞—Ç—å —Å–∞–º–æ–º—É –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ üôÅ
    
- –ö–µ—à –ª–∏–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞. –ù–µ –Ω—É–∂–Ω–æ –∑–∞–±—ã–≤–∞—Ç—å –ø—Ä–æ –∫–µ—à –ª–∏–Ω–∏–∏. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö ‚Äî —ç—Ç–æ –µ—â—ë –∏ –ø—Ä–æ–±–ª–µ–º–∞ –¥–ª—è –∫–µ—à–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–º—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ CPU —É–∂–µ –≤–∑—è–ª —Å–µ–±–µ –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ. –ü—Ä–∏ —ç—Ç–æ–º –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å Go –≤ —Ç–æ–º, —á—Ç–æ —É –Ω–∞—Å –Ω–µ —Ç—Ä–µ–¥—ã, –∞ –≥–æ—Ä—É—Ç–∏–Ω—ã, –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–∏—à–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —è–¥—Ä—É CPU, –Ω–µ –ø—Ä–æ–π–¥—É—Ç (—Ö–æ—Ç—å —ç—Ç–æ –∏ —á–∞—Å—Ç—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö).
    

### –°—Ç—Ä–æ–∫–∏

–ö–æ–≥–¥–∞ –º—ã –≥–æ–≤–æ—Ä–∏–º –ø—Ä–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –≤—Å–ø–ª—ã–≤–∞–µ—Ç —Ç–µ–º–∞ —Å—Ç—Ä–æ–∫, —Ç–æ —Ç—É—Ç –∂–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏ Unsafe.

#### Unsafe

–£ Unsafe –≤ Go –µ—Å—Ç—å —Ä—è–¥ –ø—Ä–æ–±–ª–µ–º. –ü–µ—Ä–≤–∞—è ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ –ø–µ—Ä–µ–≤–æ–¥ –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤¬†`[]byte`¬†–∏ –æ–±—Ä–∞—Ç–Ω–æ –¥–∞—ë—Ç Unsafe-—Å—Ç—Ä–æ—á–∫—É, —Ç–æ –µ—Å—Ç—å –ª—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ¬†`[]byte`¬†–æ—Ç—Ä–∞–∑–∏—Ç—Å—è –Ω–∞ –ø–æ–ª—É—á–∞–µ–º–æ–π –≤–∞–º–∏ —Å—Ç—Ä–æ–∫–µ.

–ù–æ –Ω–∞—á–∏–Ω–∞—è —Å Go 1.20 –≤–∞–º –Ω–µ –Ω–∞–¥–æ –ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–≤–æ–¥—è—Ç –∏–∑¬†`[]byte`¬†–≤ —Å—Ç—Ä–æ—á–∫—É –∏ –∏–∑ —Å—Ç—Ä–æ—á–∫–∏ –≤¬†`[]byte`, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ. –í –Ω–µ–π –ø–æ—è–≤–∏–ª–∏—Å—å¬†`unsafe.StringData`¬†–∏¬†`unsafe.String`. –≠—Ç–æ –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ—á–µ–Ω—å —á–∞—Å—Ç–æ –Ω–∞ Stack Overflow –∏ –ø–æ–¥–æ–±–Ω—ã—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö –º–æ–∂–Ω–æ –Ω–∞—Ç–∫–Ω—É—Ç—å—Å—è –Ω–∞ –æ—Ç–≤–µ—Ç—ã, –≥–¥–µ —Ç–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ—à–∏–±–æ—á–Ω–æ.

#### –ö–∞–∫–∏–µ –µ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞–¥ —Å—Ç—Ä–æ–∫–∞–º–∏ –≤ Go¬†

- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Ü–∏–∫–ª–µ¬†`for`-`range`¬†–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –∞–ª–ª–æ–∫–∞—Ü–∏–π.
    
    ```
    s := "GolangConf"for _, b := range []byte{s} { // 0 –∞–ª–ª–æ–∫–∞—Ü–∏–∏ÃÜ	// ...} 
    ```
    
    _–ö–æ–≥–¥–∞ –≤—ã –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç–µ—Å—å —á–µ—Ä–µ–∑_¬†`for`-`range`¬†–ø–æ —Å—Ç—Ä–æ–∫–µ, –ø—Ä–∏–≤–æ–¥—è –µ—ë –≤¬†`[]byte`¬†–∏–ª–∏ –≤¬†`[]rune`, —ç—Ç–æ –Ω–µ –¥–∞—ë—Ç –∞–ª–ª–æ–∫–∞—Ü–∏–π.
    
- _–ü—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å–ª–∞–π—Å–æ–≤ –±–∞–π—Ç–æ–≤, –∫–æ–≥–¥–∞ –º—ã –ø–µ—Ä–µ–≤–æ–¥–∏–º –∏—Ö –∫ —Å—Ç—Ä–æ–∫–µ._
    
    ```
    s1 := []byte{0: 65, 1024: 90}s2 := []byte{0: 65, 1024: 90}if string(s1) == string(s2) { // 0 –∞–ª–ª–æ–∫–∞—Ü–∏–∏ÃÜ	// ...}
    ```
    
    _–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞_¬†`[]byte`¬†–∫–∞–∫ —Å—Ç—Ä–æ—á–∫–∏ (–Ω–∞–ø–æ–º–Ω—é, —á—Ç–æ –∏—Ö –Ω–µ–ª—å–∑—è —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ == –Ω–∞–ø—Ä—è–º—É—é), —Ç–æ —ç—Ç–æ —Ç–æ–∂–µ –Ω–µ –¥–∞—ë—Ç –∞–ª–ª–æ–∫–∞—Ü–∏–π. –í–∞–º –≤ —ç—Ç–æ–º –º–µ—Å—Ç–µ –Ω–µ –Ω—É–∂–µ–Ω –Ω–∏–∫–∞–∫–æ–π Unsafe :)
    
- _–ü—Ä–∏ –ø–æ–∏—Å–∫–µ –≤ map._
    
    ```
    var m map[string]anykey := []byte{...}value := m[string(key)] // 0 –∞–ª–ª–æ–∫–∞—Ü–∏–∏ÃÜ
    ```
    
    _–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ –µ—Å–ª–∏ –∫–ª—é—á–æ–º –≤_¬†`map`¬†—è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞, –∞ –Ω–∞ —Ä—É–∫–∞—Ö —É –Ω–∞—Å¬†`[]byte`, —Ç–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Å–ª–∞–π—Å–∞ –±–∞–π—Ç –∫ —Å—Ç—Ä–æ–∫–µ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∫–ª—é—á–∞ –∞–ª–ª–æ–∫–∞—Ü–∏–π –Ω–µ –¥–∞—Å—Ç.
    
- _–ü—Ä–∏ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏._
    
    _–ï—Å—Ç—å –æ–≥—Ä–æ–º–Ω—ã–π –ø–ª–∞—Å—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –ø—Ä–∏ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ —Å–ª–∞–π—Å–∞ –±–∞–π—Ç_¬†`foo`¬†–∏¬†`bar`. –í —Å—Ç—Ä–æ—á–∫–µ¬†**a**¬†–º—ã –∏—Ö –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ–º —Å –Ω–µ–ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π, –∞ –≤ —Å—Ç—Ä–æ—á–∫–µ¬†**b**¬†–¥–µ–ª–∞–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ, —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∞ –ø—É—Å—Ç–∞—è.¬†
    
    ```
    foo := []byte{100: 65}bar := []byte{100: 65}a := "_" + string(foo) + string(bar)b := "" + string(foo) + string(bar)
    ```
    
    –ü–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç—Ä–æ–∫–∏¬†**a**¬†–±—É–¥–µ—Ç –≤—Å–µ–≥–æ –æ–¥–Ω–∞ –∞–ª–ª–æ–∫–∞—Ü–∏—è, —Ö–æ—Ç—è –¥–ª—è —Å—Ç—Ä–æ–∫–∏¬†**b**¬†‚Äî —Ü–µ–ª—ã—Ö —Ç—Ä–∏.
    
    –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É —Ç–∞–∫, –Ω—É–∂–Ω–æ —Å–Ω–æ–≤–∞ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∞—Å—Å–µ–º–±–ª–µ—Ä.
    
    ![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/326/4cf/013/3264cf0138362ea122a3e8a928abe1ac.png)
    
    –°–ª–µ–≤–∞ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å –Ω–µ–ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π, —Å–ø—Ä–∞–≤–∞ —Å –ø—É—Å—Ç–æ–π. –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å –Ω–µ–ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π ‚Äî —ç—Ç–æ –ø–æ —Ñ–∞–∫—Ç—É –∑–Ω–∞—á–∏—Ç –ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å –≤—Å–µ—Ö –Ω–∞—à–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ –ø–∞–∫–µ—Ç–∞ –≤ runtime. –í —Å–ª—É—á–∞–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ —Å –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π –Ω–∞–º –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞¬†`foo`¬†–∏¬†`bar`¬†–ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å—Ç—Ä–æ–∫–µ, –∏ —É–∂–µ –ø–æ—Ç–æ–º –≤—ã–∑–≤–∞—Ç—å —Ç—É –∂–µ —Å–∞–º—É—é —Ñ—É–Ω–∫—Ü–∏—é.
    
    –°—É—Ç—å –≤ —Ç–æ–º, —á—Ç–æ Go, –ø–æ–Ω–∏–º–∞—è, —á—Ç–æ —É –Ω–µ–≥–æ —É–∂–µ –µ—Å—Ç—å –∫–∞–∫–∞—è-—Ç–æ –∏—Å—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –Ω–µ–Ω—É–ª–µ–≤–æ–π –¥–ª–∏–Ω–æ–π, –º–æ–∂–µ—Ç –Ω–∞ –µ—ë –æ—Å–Ω–æ–≤–µ —Å—Ä–∞–∑—É –∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é –ø–∞–º—è—Ç—å, —Ç–æ –µ—Å—Ç—å –µ–º—É –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –¥–ª—è foo, –∑–∞—Ç–µ–º –¥–ª—è¬†`bar`¬†–∏ –ø–æ—Ç–æ–º —É–∂–µ –¥–ª—è –≤—Å–µ–π —Å—Ç—Ä–æ–∫–∏.
    
    –ü—Ä–∏ —ç—Ç–æ–º, –µ—Å–ª–∏ –º—ã –∑–∞–π–¥—ë–º –≤ –ø–∞–∫–µ—Ç, –≥–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏, —Ç–æ –Ω–∞—Å –≤—Å—Ç—Ä–µ—Ç–∏—Ç —Å—Ç—Ä–∞–Ω–Ω–∞—è —à—Ç—É–∫–∞ (–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –Ω–∏–∂–µ –≤—ã–¥–µ–ª–µ–Ω–∞ –∫—Ä–∞—Å–Ω—ã–º –±–ª–æ–∫–æ–º), –∫–æ—Ç–æ—Ä–∞—è –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –∫–∞–∫–æ–π-—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 32 –±–∞–π—Ç–∞.
    
    ![](https://habrastorage.org/r/w1560/getpro/habr/upload_files/4d9/e54/76d/4d9e5476dc8232441badafb0300142b7.png)
    
    –ö–∞–∫ –º—ã –º–æ–∂–µ–º —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å? –ö–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫–∏ —á–∞–Ω–∫–∞–º–∏ –ø–æ 32 –±–∞–π—Ç–∞. –ù–∞–º –Ω–µ –Ω–∞–¥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–µ–π —Å –ø—É—Å—Ç–æ–π –∏ –Ω–µ–ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π.¬†
    
    ![–ï—Å–ª–∏ –º—ã –∑–∞–ø—É—Å—Ç–∏–º –±–µ–Ω—á–º–∞—Ä–∫, —Ç–æ —É–≤–∏–¥–∏–º, —á—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é —á–∞–Ω–∫–æ–≤ –ø–æ 32 –±–∞–π—Ç–∞ —Ç–∞–∫–∂–µ –¥–µ–ª–∞–µ—Ç –≤—Å–µ–≥–æ –æ–¥–Ω—É –∞–ª–ª–æ–∫–∞—Ü–∏—é –¥–ª—è –≤—Å–µ–π –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.](https://habrastorage.org/r/w1560/getpro/habr/upload_files/4e7/c14/56c/4e7c1456c853dd9f9293950cfa7ee041.png "–ï—Å–ª–∏ –º—ã –∑–∞–ø—É—Å—Ç–∏–º –±–µ–Ω—á–º–∞—Ä–∫, —Ç–æ —É–≤–∏–¥–∏–º, —á—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é —á–∞–Ω–∫–æ–≤ –ø–æ 32 –±–∞–π—Ç–∞ —Ç–∞–∫–∂–µ –¥–µ–ª–∞–µ—Ç –≤—Å–µ–≥–æ –æ–¥–Ω—É –∞–ª–ª–æ–∫–∞—Ü–∏—é –¥–ª—è –≤—Å–µ–π –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.")
    
    –ï—Å–ª–∏ –º—ã –∑–∞–ø—É—Å—Ç–∏–º –±–µ–Ω—á–º–∞—Ä–∫, —Ç–æ —É–≤–∏–¥–∏–º, —á—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é —á–∞–Ω–∫–æ–≤ –ø–æ 32 –±–∞–π—Ç–∞ —Ç–∞–∫–∂–µ –¥–µ–ª–∞–µ—Ç –≤—Å–µ–≥–æ –æ–¥–Ω—É –∞–ª–ª–æ–∫–∞—Ü–∏—é –¥–ª—è –≤—Å–µ–π –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
    
    `BenchmarkSimpleConcat-8 14532418 72.20 ns/op 512 B/op 3 allocs/op`
    
    `BenchmarkChunkConcat-8 16568988 64.24 ns/op 256 B/op 1 allocs/op`
    
    –£ —ç—Ç–æ–≥–æ –∑–Ω–∞–Ω–∏—è –µ—Å—Ç—å –µ—â—ë –æ–¥–Ω–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ. –õ—é–±—ã–µ –±–µ–Ω—á–º–∞—Ä–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø–∏—à–µ—Ç–µ, –æ–±—è–∑–∞–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –æ–±—ä—ë–º—É, –ø—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–æ–º—É –∫ –æ–±—ä—ë–º—É –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ —É –≤–∞—Å –±—É–¥—É—Ç –Ω–∞ –ø—Ä–æ–¥–µ. –ò–Ω–∞—á–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–µ —É–≤–∏–¥–µ—Ç—å —Ç–µ—Ö –∞–ª–ª–æ–∫–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –µ—Å—Ç—å.
    
    –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —ç—Ç–æ–≥–æ —Ö–∞–∫–∞ –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏–º–µ–Ω–∏–º –æ–Ω —Ç–æ–ª—å–∫–æ –≤ –∫–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ—Å–ª–∏ –≤—ã –Ω–∞–ø–∏—à–µ—Ç–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ —Å —Ü–∏–∫–ª–æ–º, —ç—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏–ª—å–Ω–æ —Ö—É–∂–µ.
    

#### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–ª–∞–π—Å–∞ —Å—Ç—Ä–æ–∫

–°–æ–≤—Å–µ–º –Ω–µ–¥–∞–≤–Ω–æ –Ω–∞ GitHub –ø–æ—è–≤–∏–ª—Å—è¬†[—Ç–∏–∫–µ—Ç](https://github.com/golang/go/issues/61725#issuecomment-1788751754). –û–Ω –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ —Å–µ–π—á–∞—Å –≤ Go¬†`sort.Strings`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–ø—Ä—è–º—É—é —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏, –¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞ 30 % –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –¥–∂–µ–Ω–µ—Ä–∏–∫-—Ä–µ—à–µ–Ω–∏–µ¬†`slices.Sort`. –≠—Ç–æ –≤—ã–∑–≤–∞–Ω–æ —Ç–µ–º, —á—Ç–æ¬†`sort.Strings`¬†–¥–µ–ª–∞–µ—Ç –≤—Å–µ–≥–æ –æ–¥–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ç—Ä—ë—Ö.¬†–°–µ–π—á–∞—Å –≤ Go –Ω–µ–ª—å–∑—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É –ø–æ–ª—é.

### –ß—Ç–æ –ø–æ–ª—É—á–∞–µ–º –≤ —Å—É—Ö–æ–º –æ—Å—Ç–∞—Ç–∫–µ

- –Ø —Ä–∞—Å—Å–∫–∞–∑–∞–ª, —á—Ç–æ —Ç–∞–∫–æ–µ small-size –æ–±—ä–µ–∫—Ç—ã –∏ –∫–∞–∫ –æ–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥.
    
- –û—á–µ–Ω—å –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ —É–±–µ–¥–∏–ª –≤–∞—Å –≤ —Ç–æ–º, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã ‚Äî –∑–ª–æ. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–∂–∞—Ç—å –º–∞–∫—Å–∏–º—É–º, —Ç–æ –ø—Ä–æ –Ω–∏—Ö –Ω—É–∂–Ω–æ –∑–∞–±—ã—Ç—å.
    
- –Ø –ø–æ–∫–∞–∑–∞–ª, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–∞ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
    
- –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª, –∫–∞–∫ —Å–∏–ª—å–Ω–æ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–ª–∏—è–µ—Ç —Ç–æ—Ç –∏–ª–∏ –∏–Ω–æ–π —Ü–∏–∫–ª –∏ —á—Ç–æ —Ä–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –≤ Go —Ö–æ—Ä–æ—à–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞.
    

–ù–∞–¥–µ—é—Å—å, –º–æ–π –æ–ø—ã—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –≤—ã–∂–∞—Ç—å –∏–∑ Go –º–∞–∫—Å–∏–º—É–º ‚Äî –∏ —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ–¥—É–∫—Ç –µ—â—ë –∫—Ä—É—á–µ –∏ –±—ã—Å—Ç—Ä–µ–µ.

_–í –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç—å–∏ ‚Äî –¥–æ–∫–ª–∞–¥ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ Saint HighLoad++._¬†[_–ó–¥–µ—Å—å_](https://www.youtube.com/watch?v=QMC9Kg4Ogxg&feature=youtu.be)¬†_–º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å—å –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è._