{"groups_last_id":"3","groups":[{"id":1,"name":"Test 1"},{"id":2,"name":"Test 2"},{"id":3,"name":"Test 3"}],"categories_last_id":"4","categories":[{"id":1,"name":"Test 1","is_opened":false,"parent_id":null,"group_id":"1"},{"id":2,"name":"Test 2","is_opened":false,"parent_id":"1","group_id":"1"},{"id":3,"name":"Test 3","is_opened":false,"parent_id":"2","group_id":"1"},{"id":4,"name":"Test 4","is_opened":false,"parent_id":null,"group_id":"1"}],"articles_last_id":7,"articles":[{"id":1,"name":"Test 1","category_id":"1","html":"<b>Banken, die die auf internationaler Ebene hat</b> der Ausschuss eine Reihe einheitlicher Kennzahlen entwickelt, dies als das Minimum hinaus betreffen. Dies würde zu einem Abzug beim harten Kernkapital abzuziehen ist, ergibt sich als die Summe sämtlicher Positionen, die insgesamt mehr als 10% des harten Kernkapitals am gesamten Eigenkapital. Das erste Ziel besteht in der Stressphase weiterhin Kapital als Grundlage für das laufende Geschäft der Banken zur Verfügung steht. Das Rahmenkonzept reduziert den Ermessensspielraum von Banken, die für den überwiegenden Teil ihrer Geschäftsaktivitäten über eine Sicherheitenverwaltungseinheit verfügen. Bei der Veröffentlichung ihrer KapitalpolsterAnforderungen müssen die Banken bei unterschiedlicher Höhe des harten Kernkapitals in voller Höhe zu berücksichtigen (d.h. Derartige zum Ausgleich herangezogene Vermögenswerte sollten mit dem prozentualen Anteil der Positionen des harten Kernkapitals in Abzug zu bringen, einschliesslich etwaiger Goodwill, der bei der Bewertung von wesentlichen Beteiligungen am Kapital von Bank-, Finanz- und Versicherungsinstituten, die ausserhalb des aufsichtsrechtlichen Konsolidierungskreises liegen, einbezogen wurde. Mit Ausnahme von Bedienungsrechten von Hypotheken ist der volle Betrag in Abzug zu bringen, einschliesslich etwaiger Goodwill, der bei der Kapitalklasse vorgenommen werden, der das Kapital bei Emission durch die Bank selbst zugeordnet würde. Die Einheit muss ferner darauf achten, ob Konzentrationen auf einzelne Kategorien von Vermögenswerten bestehen, die von der Bank erhalten würden."},{"id":2,"name":"Test 2","category_id":"1","html":"dfasdf"},{"id":3,"name":"Test 3","category_id":"1","html":"<p>asdfas fdasf</p>"},{"id":4,"name":"Test 4","category_id":"1","html":"<p>Всех с наступившим Новым Годом! В этой заметке я расскажу о том как модифицировать прошивку роутера D-Link DWR-M921, вдруг кому эта информация пригодится.</p><p><br></p><p><em style=\"color: rgb(126, 110, 111);\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/a8b/7de/bf0/a8b7debf09d302c7992bf330094927e8.png\" height=\"720\" width=\"1280\"></em></p><p>Привели меня к этому попытки установить на роутер блокировщик рекламы AdGuardHome. Чипсет RTL8197F на котором работает сабж на данный момент не имеет полной поддержки OpenWRT, исходных кодов прошивки от D-Link'а нет, а попытки что-то собрать из древних RealTek'овских SDK для семейства rtl819x которые я нашел на&nbsp;<a href=\"https://sourceforge.net/projects/rtl819x/files/\" rel=\"noopener noreferrer\" target=\"_blank\" style=\"color: rgb(84, 142, 170); background-color: initial;\">SourceForge</a>&nbsp;не увенчались успехом.</p><p>К счастью, на плате нашелся UART. Бутлог под спойлером:</p><p>Бутлог</p><p>Booting...</p><p>init_ram</p><p>M init ddr ok</p><p>DRAM Type: DDR2</p><p>DRAM frequency: 400MHz</p><p>DRAM Size: 128MB</p><p>JEDEC id EF4017, EXT id 0x0000</p><p>found w25q64</p><p>flash vendor: Winbond</p><p>w25q64, size=8MB, erasesize=4KB, max_speed_hz=29000000Hz</p><p>auto_mode=0 addr_width=3 erase_opcode=0x00000020</p><p>=&gt;CPU Wake-up interrupt happen! GISR=89000004</p><p>---Realtek RTL8197F boot code at 2020.11.02-17:16+0800 v3.4T-pre2.1 (999MHz)</p><p>bootbank is 1, bankmark 80000006</p><p>Jump to image start=0x80a00000...</p><p>return_addr = b0030000 ,boot bank=1, bank_mark=0x80000006...</p><p>decompressing kernel:</p><p>Uncompressing Linux... done, booting the kernel.</p><p>done decompressing kernel.</p><p>start address: 0x8051f440</p><p>Linux version 3.10.90 (jenkins@zhao-MS-7B23) (gcc version 4.4.7 (Realtek MSDK-4.4.7 Build 2001) ) #12 Mon Aug 9 10:52:50 CST 2021</p><p>bootconsole [early0] enabled</p><p>CPU revision is: 00019385 (MIPS 24Kc)</p><p>Determined physical RAM map:</p><p>memory: 08000000 @ 00000000 (usable)</p><p>Zone ranges:</p><p>Normal [mem 0e start for each node</p><p>Early memory node ranges</p><p>node 0: [mem 0x00000000-0x07ffffff]</p><p>Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.</p><p>Primary data cache 32kB, 4-way, PIPT, no aliases, linesize 32 bytes</p><p>Built 1 zonelists in Zone order, mobility grouping on. Total pages: 8176</p><p>Kernel command line: console=ttyS0,38400 root=/dev/mtdblock1</p><p>PID hash table entrix00000000-0x07ffffff]</p><p>Movable zones: 512 (order: -3, 2048 bytes)</p><p>Dentry cache hash table entries: 16384 (order: 2, 65536 bytes)</p><p>Inode-cache hash table entries: 8192 (order: 1, 32768 bytes)</p><p>Writing ErrCtl register=00002bcb</p><p>Readback ErrCtl register=00002bcb</p><p>Memory: 114544k/131072k available (5267k kernel code, 16528k reserved, 1733k data, 224k init, 0k highmem)</p><p>SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1</p><p>NR_IRQS:192</p><p>Realtek GPIO IRQ init</p><p>Calibrating delay loop... 660.68 BogoMIPS (lpj=3303424)</p><p>pid_max: default: 32768 minimum: 301</p><p>Mount-cache hash table entries: 2048</p><p>devtmpfs: initialized</p><p>NET: Registered protocol family 16</p><p>&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;</p><p>Do MDIO_RESET</p><p>40MHz</p><p>PCIE -&gt; Cannot LinkUP</p><p>INFO: initializing USB devices ...</p><p>enable port 0 two port enable</p><p>port 0 org 0xe0=e2</p><p>port 0 org 0xe1=31</p><p>port 0 org 0xe2=39</p><p>port 0 org 0xe4=98</p><p>port 0 org 0xe6=c0</p><p>port 1 org 0xe0=e2</p><p>port 1 org 0xe1=31</p><p>port 1 org 0xe2=39</p><p>port 1 org 0xe4=98</p><p>port 1 org 0xe6=c0</p><p>patch new usb phy para for 40M OSC</p><p>system reg b8000010=0x80043000</p><p>system reg b8000014=0x118</p><p>system reg b8000160=0x1</p><p>system reg b8000164=0x0</p><p>system reg b8000168=0x0</p><p>system reg b800016c=0x280500</p><p>system reg b8000180=0x60000</p><p>system reg b8021094=0x200020</p><p>system reg b8140200=0xf002cc11</p><p>system reg b8140204=0x0</p><p>system reg b8140208=0x2010000</p><p>system reg b814020c=0x9b00</p><p>system reg b8140210=0xca00ca</p><p>EHCI reg b8021050=0x0</p><p>EHCI reg b8021054=0x2000</p><p>EHCI reg b8021058=0x2000</p><p>OHCI reg b8020000=0x110</p><p>OHCI reg b8020004=0x0</p><p>port 0 reg e0=e2</p><p>port 0 reg e1=31</p><p>port 0 reg e2=33</p><p>port 0 reg e3=8d</p><p>port 0 reg e4=c9</p><p>port 0 reg e5=19</p><p>port 0 reg e6=c1</p><p>port 0 reg e7=91</p><p>port 0 reg f0=fc</p><p>port 0 reg f1=8c</p><p>port 0 reg f2=0</p><p>port 0 reg f3=11</p><p>port 0 reg f4=9b</p><p>port 0 reg f5=4</p><p>port 0 reg f6=0</p><p>port 1 reg e0=e2</p><p>port 1 reg e1=31</p><p>port 1 reg e2=33</p><p>port 1 reg e3=8d</p><p>port 1 reg e4=c9</p><p>port 1 reg e5=19</p><p>port 1 reg e6=c1</p><p>port 1 reg e7=91</p><p>port 1 reg f0=fc</p><p>port 1 reg f1=8c</p><p>port 1 reg f2=0</p><p>port 1 reg f3=11</p><p>port 1 reg f4=9b</p><p>port 1 reg f5=4</p><p>port 1 reg f6=0</p><p>Realtek GPIO controller driver init</p><p>INFO: registering sheipa spi device</p><p>bio: create slab at 0</p><p>SCSI subsystem initialized</p><p>INFO: sheipa spi driver register</p><p>INFO: sheipa spi probe</p><p>usbcore: registered new interface driver usbfs</p><p>usbcore: registered new interface driver hub</p><p>usbcore: registered new device driver usb</p><p>Switching to clocksource MIPS</p><p>NET: Registered protocol family 2</p><p>TCP established hash table entries: 2048 (order: 0, 16384 bytes)</p><p>TCP bind hash table entries: 2048 (order: -1, 8192 bytes)</p><p>TCP: Hash tables configured (established 2048 bind 2048)</p><p>TCP: reno registered</p><p>UDP hash table entries: 1024 (order: 0, 16384 bytes)</p><p>UDP-Lite hash table entries: 1024 (order: 0, 16384 bytes)</p><p>NET: Registered protocol family 1</p><p>squashfs: version 4.0 (2009/01/31) Phillip Lougher</p><p>exFAT: Version 1.2.9</p><p>NTFS driver 2.1.30 [Flags: R/W].</p><p>fuse init (API version 7.22)</p><p>msgmni has been set to 223</p><p>Block layer SCSI generic (bsg) driver version 0.4 loaded (major 254)</p><p>io scheduler noop registered (default)</p><p>Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled</p><p>console [ttyS0] enabled, bootconsole disabled7) is a 16550A</p><p>console [ttyS0] enabled, bootconsole disabled</p><p>Realtek GPIO Driver for Flash Reload Default</p><p>loop: module loaded</p><p>m25p80 spi0.0: change speed to 15000000Hz, div 7</p><p>JEDEC id EF4017</p><p>m25p80 spi0.0: found w25q64, expected m25p80</p><p>flash vendor: Winbond</p><p>m25p80 spi0.0: w25q64 (8192 Kbytes) (29000000 Hz)</p><p>4 rtkxxpart partitions found on MTD device m25p80</p><p>Creating 4 MTD partitions on \"m25p80\":</p><p>0x000000000000-0x000000300000 : \"boot+cfg+linux\"</p><p>0x000000300000-0x000000800000 : \"rootfs\"</p><p>0x000000800000-0x000000b00000 : \"boot+cfg+linux2\"</p><p>mtd: partition \"boot+cfg+linux2\" is out of reach -- disabled</p><p>0x000000b00000-0x000001000000 : \"rootfs2\"</p><p>mtd: partition \"rootfs2\" is out of reach -- disabled</p><p>PPP generic driver version 2.4.2</p><p>PPP BSD Compression module registered</p><p>PPP Deflate Compression module registered</p><p>NET: Registered protocol family 24</p><p>MPPE/MPPC encryption/compression module registered</p><p>Realtek WLAN driver - version 1.7 (2015-10-30)(SVN:9914)</p><p>Adaptivity function - version 9.3.4</p><p>MACHAL_version_init</p><p>RFE TYPE =0</p><p>##########(wlan0)##########</p><p>SKB_BUF_SIZE[2472] MAX_SKB_NUM[1500]</p><p>NUM_RX_DESC[512] NUM_TX_DESC[512]</p><p>MAX_RX_BUF_LEN[2040]</p><p>############################</p><p>RFE TYPE =0</p><p>RFE TYPE =0</p><p>RFE TYPE =0</p><p>RFE TYPE =0</p><p>RFE TYPE =0</p><p>usbcore: registered new interface driver asix</p><p>usbcore: registered new interface driver ax88179_178a</p><p>usbcore: registered new interface driver cdc_ether</p><p>usbcore: registered new interface driver net1080</p><p>usbcore: registered new interface driver rndis_host</p><p>usbcore: registered new interface driver cdc_subset</p><p>usbcore: registered new interface driver zaurus</p><p>usbcore: registered new interface driver cdc_ncm</p><p>GobiNet: Quectel_Linux_GobiNet_SR01A02V16</p><p>usbcore: registered new interface driver GobiNet</p><p>ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver</p><p>rtl819x-ehci rtl819x-ehci: Realtek rtl819x On-Chip EHCI Host Controller</p><p>rtl819x-ehci rtl819x-ehci: new USB bus registered, assigned bus number 1</p><p>rtl819x-ehci rtl819x-ehci: irq 21, io mem 0x18021000</p><p>rtl819x-ehci rtl819x-ehci: USB 2.0 started, EHCI 1.00</p><p>usb usb1: New USB device found, idVendor=1d6b, idProduct=0002</p><p>usb usb1: New USB device strings: Mfr=3, Product=2, SerialNumber=1</p><p>usb usb1: Product: Realtek rtl819x On-Chip EHCI Host Controller</p><p>usb usb1: Manufacturer: Linux 3.10.90 ehci_hcd</p><p>usb usb1: SerialNumber: rtl819x-ehci</p><p>hub 1-0:1.0: USB hub found</p><p>hub 1-0:1.0: 2 ports detected</p><p>ehci-platform: EHCI generic platform driver</p><p>ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver</p><p>rtl819x-ohci rtl819x-ohci: Realtek rtl819x built-in OHCI controller</p><p>rtl819x-ohci rtl819x-ohci: new USB bus registered, assigned bus number 2</p><p>rtl819x-ohci rtl819x-ohci: irq 21, io mem 0x18020000</p><p>usb usb2: New USB device found, idVendor=1d6b, idProduct=0001</p><p>usb usb2: New USB device strings: Mfr=3, Product=2, SerialNumber=1</p><p>usb usb2: Product: Realtek rtl819x built-in OHCI controller</p><p>usb usb2: Manufacturer: Linux 3.10.90 ohci_hcd</p><p>usb usb2: SerialNumber: rtl819x-ohci</p><p>hub 2-0:1.0: USB hub found</p><p>hub 2-0:1.0: 2 ports detected</p><p>uhci_hcd: USB Universal Host Controller Interface driver</p><p>usbcore: registered new interface driver cdc_acm</p><p>cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters</p><p>usbcore: registered new interface driver cdc_wdm</p><p>usbcore: registered new interface driver usb-storage</p><p>usbcore: registered new interface driver usbserial</p><p>usbcore: registered new interface driver usbserial_generic</p><p>usbserial: USB Serial support registered for generic</p><p>usbcore: registered new interface driver option</p><p>usbserial: USB Serial support registered for GSM modem (1-port)</p><p>usbcore: registered new interface driver GobiSerial</p><p>usbserial: USB Serial support registered for GobiSerial</p><p>GobiSerial: 2015-08-27/SWI_2.25:GobiSerial</p><p>Otg act as Host mode</p><p>=&gt;do UTMI reset, r=1</p><p>=&gt;do UTMI reset, r=0</p><p>RTL8197F u2 phy 40MHz patch</p><p>reg e0=e2</p><p>reg e1=31</p><p>reg e2=33</p><p>reg e3=8d</p><p>reg e4=c9</p><p>reg e5=19</p><p>reg e6=c1</p><p>reg e7=91</p><p>reg f0=fc</p><p>reg f1=8c</p><p>reg f2=0</p><p>reg f3=11</p><p>reg f4=9b</p><p>reg e0=25</p><p>reg e1=4f</p><p>reg e2=0</p><p>reg e3=0</p><p>reg e4=0</p><p>reg e5=a</p><p>reg e6=0</p><p>reg e7=0</p><p>reg f0=fc</p><p>reg f1=8c</p><p>reg f2=0</p><p>reg f3=11</p><p>reg f4=bb</p><p>=&gt;do UTMI reset, r=1</p><p>=&gt;do UTMI reset, r=0</p><p>create lmdev=87262f00</p><p>device_register :register pass</p><p>dwc_otg: version 3.10b 20-MAY-2013</p><p>dwc_otg_driver_probe(87262f00)</p><p>start=0xb8030000</p><p>base=0xb8030000</p><p>dwc_otg_device=0x87347b00</p><p>Core Release: 3.10a</p><p>Setting default values for core params</p><p>=&gt; SNPSID=4f54310a</p><p>Using Buffer DMA mode</p><p>Periodic Transfer Interrupt Enhancement - disabled</p><p>Multiprocessor Interrupt Enhancement - disabled</p><p>OTG VER PARAM: 0, OTG VER FLAG: 0</p><p>Shared Tx FIFO mode</p><p>dwc_otg logicmodule: DWC OTG Controller</p><p>dwc_otg logicmodule: new USB bus registered, assigned bus number 3</p><p>dwc_otg logicmodule: irq 20, io mem 0xb8030000</p><p>Init: Power Port (0)</p><p>usb usb3: New USB device found, idVendor=1d6b, idProduct=0002</p><p>usb usb3: New USB device strings: Mfr=3, Product=2, SerialNumber=1</p><p>usb usb3: Product: DWC OTG Controller</p><p>usb usb3: Manufacturer: Linux 3.10.90 dwc_otg_hcd</p><p>usb usb3: SerialNumber: logicmodule</p><p>hub 3-0:1.0: USB hub found</p><p>hub 3-0:1.0: 1 port detected</p><p>u32 classifier</p><p>nf_conntrack version 0.5.0 (1789 buckets, 7156 max)</p><p>gre: GRE over IPv4 demultiplexor driver</p><p>ip_gre: GRE over IPv4 tunneling driver</p><p>ip_tables: (C) 2000-2006 Netfilter Core Team</p><p>TCP: cubic registered</p><p>NET: Registered protocol family 10</p><p>ip6_tables: (C) 2000-2006 Netfilter Core Team</p><p>sit: IPv6 over IPv4 tunneling driver</p><p>NET: Registered protocol family 17</p><p>Bridge firewalling registered</p><p>Ebtables v2.0 registered</p><p>l2tp_core: L2TP core driver, V2.0</p><p>l2tp_ip: L2TP IP encapsulation support (L2TPv3)</p><p>l2tp_netlink: L2TP netlink interface</p><p>l2tp_eth: L2TP ethernet pseudowire support (L2TPv3)</p><p>8021q: 802.1Q VLAN Support v1.8</p><p>Realtek FastPath:v1.03</p><p>Probing RTL819X NIC-kenel stack size order[0]...</p><p>eth0 added. vid=9 Member port 0x1...</p><p>eth1 added. vid=8 Member port 0x10...</p><p>eth2 added. vid=9 Member port 0x2...</p><p>eth3 added. vid=9 Member port 0x4...</p><p>eth4 added. vid=9 Member port 0x8...</p><p>usb 1-1: new high-speed USB device number 2 using rtl819x-ehci</p><p>[peth0] added, mapping to [eth1]...</p><p>m25p80 spi0.0: change speed to 29000000Hz, div 4</p><p>VFS: Mounted root (squashfs filesystem) readonly on device 31:1.</p><p>devtmpfs: mounted</p><p>Freeing unused kernel memory: 224K (806d8000 - 80710000)</p><p>usb 1-1: New USB device found, idVendor=1508, idProduct=1001</p><p>usb 1-1: New USB device strings: Mfr=1, Product=2, SerialNumber=3</p><p>usb 1-1: Product: Fibocom NL668 Modem</p><p>usb 1-1: Manufacturer: Fibocom NL668 Modem</p><p>usb 1-1: SerialNumber: 5735bff3</p><p>option 1-1:1.0: GSM modem (1-port) converter detected</p><p>usb 1-1: GSM modem (1-port) converter now attached to ttyUSB0</p><p>option 1-1:1.1: GSM modem (1-port) converter detected</p><p>usb 1-1: GSM modem (1-port) converter now attached to ttyUSB1</p><p>option 1-1:1.2: GSM modem (1-port) converter detected</p><p>usb 1-1: GSM modem (1-port) converter now attached to ttyUSB2</p><p>option 1-1:1.3: GSM modem (1-port) converter detected</p><p>usb 1-1: GSM modem (1-port) converter now attached to ttyUSB3</p><p>GobiNet 1-1:1.4 usb0: register 'GobiNet' at usb-rtl819x-ehci-1, GobiNet Ethernet Device, e6:ac:30:6f:25:01</p><p>init started: BusyBox v1.13.4 (2021-08-09 10:47:12 CST)</p><p>creating qcqmi0</p><p>Discovery the interface for Fibocom.cp: cannot stat '/etc/avahi-daemon.conf': No such file or directory</p><p>Floating point exception</p><p>Please refine linux/.config change offset to fit flash erease size!!!!!!!!!!!!!!!!!</p><p>type:3, enable:1, percent1</p><p>sysconf init gw all</p><p><br></p><p>Init Start...</p><p><br></p><p>sysconf wlanapp kill wlan0</p><p><br></p><p>open /proc/br_wlanblock: Permission denied</p><p>Init bridge interface...</p><p>device eth0 entered promiscuous mode</p><p>device eth2 entered promiscuous mode</p><p>device eth3 entered promiscuous mode</p><p>device eth4 entered promiscuous mode</p><p>device wlan0 entered promiscuous mode</p><p>WlanSupportAbility = 0x3</p><p>[ODM_software_init]</p><p>[97F] Bonding Type 97FN, PKG2</p><p>[97F] RFE type 0 PHY paratemters: DEFAULT</p><p>clock 40MHz</p><p>load efuse ok</p><p>rom_progress: 0x200006f</p><p>rom_progress: 0x400006f</p><p>[GetHwReg88XX][PHY_REG_PG_8197Fmp_Type0] size</p><p>[GetHwReg88XX][PHY_REG_PG_8197Fmp_Type0]</p><p>[GetHwReg88XX][rtl8197Ffw]</p><p>[GetHwReg88XX][rtl8197Ffw size]</p><p>[97F] Default BB Swing=30</p><p>br0: port 5(wlan0) entered forwarding state</p><p>br0: port 5(wlan0) entered forwarding state</p><p>br0: port 4(eth4) entered forwarding state</p><p>br0: port 4(eth4) entered forwarding state</p><p>br0: port 3(eth3) entered forwarding state</p><p>br0: port 3(eth3) entered forwarding state</p><p>br0: port 2(eth2) entered forwarding state</p><p>br0: port 2(eth2) entered forwarding state</p><p>br0: port 1(eth0) entered forwarding state</p><p>br0: port 1(eth0) entered forwarding state</p><p>killall: udhcpd: no process killed</p><p>Init Wlan application...</p><p>WiFi Simple Config v2.20-wps2.0 (2017.10.20-07:08+0000).</p><p>Register to wlan0</p><p>iwcontrol RegisterPID to (wlan0)</p><p>route: SIOCDELRT: No such process</p><p>IEEE 802.11f (IAPP) using interface br0 (v1.8)</p><p>+++set_wanipv6+++2028</p><p>Start setting IPv6[IPv6]</p><p>open /proc/sys/net/ipv4/rt_cache_rebuild_count: No such file or directory</p><p>/bin/sh: addgroup: not found</p><p>passwd: unknown user tmptest</p><p>rand min=48,sec=8!</p><p>/bin/sh: addgroup: not found</p><p>Changing password for admin</p><p>New password:</p><p>Bad password: too weak</p><p>Retype password:</p><p>passwd: password for admin is unchanged</p><p>adduser: login 'admin' is in use</p><p>iptables: Bad rule (does a matching rule exist in that chain?).</p><p>iptables: Bad rule (does a matching rule exist in that chain?).</p><p>-----update_users_traffic, 667, 192, 168, 0, 1</p><p>killall: ntpd: no process killed</p><p>/etc/init.d/rcS: line 123: can't create /proc/irq/33/smp_affinity: nonexistent directory</p><p>enable 0 interval</p><p>sysconf stopWispWan</p><p><br></p><p>boa: server version Boa/0.94.14rc21</p><p>boa: server built Aug 9 2021 at 10:47:07.</p><p>boa: starting server pid=1623, port 80</p><p>type:3, enable:0, percent0</p><p>Startup Ok</p><p>В веб-интерфейсе я нашел опцию включения telnet'а, но пароль от root-пользователя нигде не обнаружил. Написал в тех-поддержку и мне его прислали.</p><pre class=\"ql-syntax\" spellcheck=\"false\">&gt; telnet 192.168.0.1\nTrying 192.168.0.1...\nConnected to 192.168.0.1.\nEscape character is '^]'.\n\nDWR-M921 login: root\nPassword: \nRLX Linux version 2.0\n         _           _  _\n        | |         | ||_|                 \n   _  _ | | _  _    | | _ ____  _   _  _  _ \n  | |/ || |\\ \\/ /   | || |  _ \\| | | |\\ \\/ /\n  | |_/ | |/    \\   | || | | | | |_| |/    \\\n  |_|   |_|\\_/\\_/   |_||_|_| |_|\\____|\\_/\\_/\n\nFor further information check:\nhttp://processor.realtek.com/\n#\n</pre><p>Но, увы, доступа к терминалу оказалось недостаточно. Всё дело в том что в роутере используется сжатая файловая система только для чтения SquashFS, которая при запуске распаковывается в оперативную память, а значит все изменения внесённые во время работы роутера пропадают после перезагрузки.</p><pre class=\"ql-syntax\" spellcheck=\"false\"># mount\nrootfs on / type rootfs (rw)\n/dev/root on / type squashfs (ro,relatime)\ndevtmpfs on /dev type devtmpfs (rw,relatime,mode=0755)\nproc on /proc type proc (rw,relatime)\nramfs on /var type ramfs (rw,relatime)\nsysfs on /sys type sysfs (rw,relatime)\ndebugfs on /sys/kernel/debug type debugfs (rw,relatime)\n# \n</pre><p>Стало понятно что для того чтобы что-то сделать придётся редактировать прошивку.</p><p><strong>Ну что ж, приступим.</strong></p><p>Скачиваем последнюю версию с&nbsp;<a href=\"https://la.dlink.com/la/soporte/?prod=dwr-m921\" rel=\"noopener noreferrer\" target=\"_blank\" style=\"color: rgb(84, 142, 170); background-color: initial;\">официального сайта</a>&nbsp;и сканируем binwalk'ом:</p><pre class=\"ql-syntax\" spellcheck=\"false\">&gt; cp /home/gleb/Downloads/DWR_M921_fw20211118140944_S10865_V1.1.52\\(1119134055\\)\\ \\(1\\).bin ./firmware.bin\n\n&gt; binwalk firmware.bin \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n10264         0x2818          LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 7374556 bytes\n2394146       0x248822        Squashfs filesystem, little endian, version 4.0, compression:xz, size: 5012602 bytes, 961 inodes, blocksize: 131072 bytes, created: 2038-04-24 04:11:44\n</pre><p>Binwalk распознал два файла, а именно linux-ядро сжатое алгоритмом lzma и файловую систему squashfs (созданную, кстати, в 2038 году). Нас интересует файловая система. Извлекаем ее из файла прошивки утилитой dd и распаковываем полученный файл командой&nbsp;<strong>unsquashfs</strong>:</p><pre class=\"ql-syntax\" spellcheck=\"false\">&gt; dd bs=1 skip=2394146 if=firmware.bin of=squashfs.sfs\n5013506+0 записей получено\n5013506+0 записей отправлено\n5013506 байт (5,0 MB, 4,8 MiB) скопирован, 21,4423 s, 234 kB/s\n\n&gt; sudo unsquashfs squashfs.sfs \nParallel unsquashfs: Using 4 processors\n920 inodes (984 blocks) to write\n\n[======================================================================================================================================================================|] 984/984 100%\n\ncreated 453 files\ncreated 41 directories\ncreated 118 symlinks\ncreated 349 devices\ncreated 0 fifos\ncreated 0 sockets\n\n&gt; ls\nfirmware.bin  squashfs-root  squashfs.sfs\n\n&gt; ls ./squashfs-root/\nbin  dev  etc  home  init  lib  mnt  proc  root  sys  tmp  usr  var  web\n\n</pre><p>Теперь мы имеем директорию&nbsp;<strong>squashfs-root</strong>&nbsp;с содержимым корневой файловой системы роутера, которое мы можем изучать и редактировать. Для эксперимента я решил сменить пароль root пользователя на роутере. Из следующей строки файла&nbsp;<strong>/etc/init.d/rcS</strong>&nbsp;нам известно что при запуске роутер создает файл&nbsp;<strong>/var/passwd</strong>&nbsp;из файла&nbsp;<strong>/etc/passwd_orig</strong>:</p><pre class=\"ql-syntax\" spellcheck=\"false\">cp /etc/passwd_orig /var/passwd\n</pre><p>Меняем хэш оригинального пароля на новый. Во избежание возни с хэшами (в которых я мало разбираюсь) я просто сменил пароль в работающем роутере командой&nbsp;<strong>passwd</strong>&nbsp;и скопировал новый хэш из файла&nbsp;<strong>/etc/passwd</strong>.</p><p>На роутере:</p><pre class=\"ql-syntax\" spellcheck=\"false\"># passwd\nChanging password for root\nNew password:\nBad password: too short\nRetype password:\nPassword for root changed by root\n# cat /var/passwd\nroot:$1$QiHO6bVZ$k8BN/N3odnO62hEutlykE1:0:0:root:/:/bin/sh\nnobody:x:0:0:nobody:/:/dev/nulltmptest:x:1000:1000:Linux User,,,:/home/tmptest:/bin/sh\nadmin:x:1000:1000:Linux User,,,:/home/admin:/bin/sh\n#\n</pre><p>В ./squashfs-root:</p><pre class=\"ql-syntax\" spellcheck=\"false\">&gt; cat ./etc/passwd_orig\nroot:$1$QiHO6bVZ$k8BN/N3odnO62hEutlykE1:0:0:root:/:/bin/sh\nnobody:x:0:0:nobody:/:/dev/null⏎\n\n&gt; sudo sed -i 's+$1$86ANwXE8$/oiI3ZYM4plYjUYzXGH3E/+$1$QiHO6bVZ$k8BN/N3odnO62hEutlykE1+g' ./etc/passwd_orig\n</pre><p>Для первого раза этих изменений хватит. Теперь нам предстоит собрать прошивку обратно и добиться того чтобы роутер принял ее. Для начала сжимаем файловую систему. Делаем мы это с помощью утилиты&nbsp;<strong>mksquashfs</strong>. Из вывода binwalk-а мы помним, что файловая система в оригинальной прошивке была сжата алгоритмом xz и имела размер блока 131072 байта. Выполняем:</p><pre class=\"ql-syntax\" spellcheck=\"false\">&gt; sudo mksquashfs ./squashfs-root/ squashfs-mod.sfs -b 131072 -comp xz\nParallel mksquashfs: Using 4 processors\nCreating 4.0 filesystem on squashfs-mod.sfs, block size 131072.\n[======================================================================================================================================================================/] 517/517 100%\n\nExportable Squashfs 4.0 filesystem, xz compressed, data block size 131072\n        compressed data, compressed metadata, compressed fragments,\n        compressed xattrs, compressed ids\n        duplicates are removed\nFilesystem size 4898.31 Kbytes (4.78 Mbytes)\n        30.50% of uncompressed filesystem size (16061.77 Kbytes)\nInode table size 6260 bytes (6.11 Kbytes)\n        21.64% of uncompressed inode table size (28929 bytes)\nDirectory table size 7320 bytes (7.15 Kbytes)\n        46.03% of uncompressed directory table size (15904 bytes)\nNumber of duplicate files found 21\nNumber of inodes 961\nNumber of files 453\nNumber of fragments 55\nNumber of symbolic links 118\nNumber of device nodes 349\nNumber of fifo nodes 0\nNumber of socket nodes 0\nNumber of directories 41\nNumber of ids (unique uids + gids) 3\nNumber of uids 2\n        gnome-initial-setup (124)\n        root (0)\nNumber of gids 1\n        pulse (128)\n\n&gt; ls\nfirmware.bin  squashfs-mod.sfs  squashfs-root  squashfs.sfs\n</pre><p>..и получаем готовый файлик с модифицированной файловой системой. Сравниваем его со старым и убеждаемся что мы все правильно сделали:</p><pre class=\"ql-syntax\" spellcheck=\"false\">&gt; binwalk squashfs.sfs\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             Squashfs filesystem, little endian, version 4.0, compression:xz, size: 5012602 bytes, 961 inodes, blocksize: 131072 bytes, created: 2038-04-24 04:11:44\n\n&gt; binwalk squashfs-mod.sfs \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             Squashfs filesystem, little endian, version 4.0, compression:xz, size: 5015866 bytes, 961 inodes, blocksize: 131072 bytes, created: 2023-01-01 14:20:39\n</pre><p>Размер файловой системы изменился, но для нас это не имеет значения, так как в оригинальной прошивке после файловой системы полно свободного места:</p><p><em style=\"color: rgb(126, 110, 111);\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/923/4ae/b33/9234aeb33960baefb30344c4bc71fd8c.png\" height=\"670\" width=\"1201\"></em></p><p>Теперь нам нужно поместить измененную ф.с. в прошивку. Делаем это с помощью команды dd:</p><pre class=\"ql-syntax\" spellcheck=\"false\">&gt; cp firmware.bin firmware-mod.bin\n&gt; dd conv=notrunc bs=1 seek=2394146 if=squashfs-mod.sfs of=firmware-mod.bin\n</pre><p>Казалось бы все готово, но нет. При попытке обновления через веб интерфейс, роутер (чего и следовало ожидать) выдает ошибку несоответствия контрольной суммы:</p><p><em style=\"color: rgb(126, 110, 111);\"><img src=\"https://habrastorage.org/r/w1560/getpro/habr/upload_files/518/a04/2cc/518a042ccd7b9cc8a0140e813009c4af.png\" height=\"174\" width=\"579\"></em></p><p>Я долго ломал голову над тем как же пересчитать чексумму (да, я пытался вставить чексумму которую выдал веб-интерфейс в конец прошивки, ничего не вышло). Толковой информации в интернете я не нашел. Наткнулся лишь на&nbsp;<a href=\"https://github.com/rampageX/firmware-mod-kit\" rel=\"noopener noreferrer\" target=\"_blank\" style=\"color: rgb(84, 142, 170); background-color: initial;\">firmware-mod-kit</a>, который способен проделать всё ранее описанное автоматически. К сожалению, пересчитать контрольные суммы он тоже не смог.</p>"},{"id":5,"name":"Derartige zum Ausgleich","category_id":"2","html":"sadf asfdasf asdf"},{"id":6,"name":"der bei der Kapitalklasse vorgenommen werden","category_id":"3","html":"sadf asfdasf asdf"},{"id":7,"category_id":4,"name":"Test 5","html":"<p>Test 5</p>"}],"favorites_last_id":"1","favorites":[{"id":1,"article_id":"1"}],"tags_last_id":"4","tags":[{"id":1,"name":"computer"},{"id":2,"name":"testing"},{"id":3,"name":"development"},{"id":4,"name":"lorem"}],"tags_relataions_last_id":"1","tags_relations":[{"id":1,"tag_id":"1","article_id":"1"}]}