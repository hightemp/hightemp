## Установка и настройка Jenkins

Установка Jenkins может быть выполнена на различных операционных системах, включая **Windows** и **Ubuntu**. Для работы Jenkins требуется **Java Development Kit (JDK)**, поэтому перед установкой необходимо убедиться в его наличии.

### Установка на Windows:

1. Скачивание установщика Jenkins с [официального сайта](https://www.jenkins.io/download/).
2. Запуск установщика и выбор пути установки.
3. Настройка способа запуска службы (рекомендуется "Run service as LocalSystem").
4. Выбор порта (по умолчанию 8080).
5. Указание пути к JDK.
6. Выбор дополнительных модулей.

### Установка на Ubuntu:

1. **Добавление ключа шифрования GPG репозитория Jenkins:**

    ```bash
    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null
    ```

2. **Добавление репозитория Jenkins в список пакетов:**

    ```bash
    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | sudo tee /etc/apt/sources.list.d/jenkins.list > /dev/null
    ```

3. **Обновление списка пакетов:**

    ```bash
    sudo apt update
    ```

4. **Установка Jenkins:**

    ```bash
    sudo apt install jenkins
    ```

5. **Запуск сервиса Jenkins:**

    ```bash
    sudo systemctl start jenkins
    ```

6. **Проверка статуса работы:**

    ```bash
    sudo service jenkins status
    ```

### Первоначальная настройка:

После установки необходимо выполнить первоначальную настройку Jenkins через веб-интерфейс, доступный по адресу `http://localhost:8080` (или соответствующему IP-адресу сервера). При первом входе потребуется ввести пароль администратора, который можно найти в файле, указанном на странице разблокировки.

### Безопасность:

Для обеспечения безопасности рекомендуется настроить брандмауэр, открыв необходимые порты, например, для SSH и веб-интерфейса Jenkins.

## Docker Compose для Jenkins

Docker Compose значительно упрощает процесс установки и настройки Jenkins, позволяя определить всю конфигурацию в одном YAML-файле. Для установки Jenkins с использованием Docker Compose выполните следующие шаги:

**1. Создайте директорию для проекта и перейдите в неё:**

```bash
mkdir jenkins_docker
cd jenkins_docker
```

**2. Создайте файл `docker-compose.yml` со следующим содержимым:**

```yaml
version: '3.8'
services:
  jenkins:
    image: jenkins/jenkins:lts
    privileged: true
    user: root
    ports:
      - 8080:8080
      - 50000:50000
    container_name: jenkins
    volumes:
      - ./jenkins_home:/var/jenkins_home
      - /var/run/docker.sock:/var/run/docker.sock
```

Этот файл определяет сервис Jenkins, использующий официальный образ LTS (Long Term Support). Порты 8080 и 50000 проброшены на хост-машину для доступа к веб-интерфейсу и подключения агентов соответственно. Том `jenkins_home` используется для сохранения данных между перезапусками контейнера.

**3. Создайте директорию для хранения данных Jenkins:**

```bash
mkdir jenkins_home
```

**4. Запустите контейнер с помощью Docker Compose:**

```bash
docker-compose up -d
```

Флаг `-d` запускает контейнер в фоновом режиме.

**5. Проверьте статус запущенного контейнера:**

```bash
docker-compose ps
```

**6. После запуска Jenkins будет доступен по адресу `http://localhost:8080`.** При первом входе потребуется ввести начальный пароль администратора. Его можно получить, выполнив команду:

```bash
docker-compose exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword
```

**7. Следуйте инструкциям на экране для завершения начальной настройки Jenkins,** включая установку рекомендуемых плагинов и создание первого администратора.

**Преимущества использования Docker Compose для установки Jenkins:**

*   **Простота настройки и управления:** вся конфигурация определена в одном файле.
*   **Портативность:** легко переносить настройки между различными средами.
*   **Изоляция:** Jenkins работает в изолированном контейнере, что повышает безопасность и упрощает управление зависимостями.
*   **Возможность легкого обновления:** для обновления Jenkins достаточно изменить тег образа в `docker-compose.yml` и перезапустить контейнер.

**Дополнительно:**

При необходимости использования дополнительных плагинов или специфических настроек, можно создать собственный Dockerfile, расширяющий базовый образ Jenkins, и использовать его в Docker Compose.

## Конфигурация нового Jenkins

После успешной установки Jenkins необходимо выполнить его начальную настройку. Этот процесс включает несколько ключевых шагов:

**1. Разблокировка Jenkins:**

*   При первом доступе к веб-интерфейсу Jenkins (обычно по адресу `http://localhost:8080` или `http://[IP-адрес сервера]:8080`) потребуется ввести начальный пароль администратора.
*   Этот пароль можно найти в файле `/var/lib/jenkins/secrets/initialAdminPassword`.
*   Для просмотра пароля выполните команду:

    ```bash
    sudo cat /var/lib/jenkins/secrets/initialAdminPassword
    ```

**2. Установка плагинов:**

*   После ввода пароля Jenkins предложит установить рекомендуемые плагины или выбрать плагины вручную.
*   Для большинства случаев достаточно выбрать **"Install suggested plugins"**. Это обеспечит базовую функциональность для начала работы.

**3. Создание первого администратора:**

*   После установки плагинов необходимо создать учетную запись администратора.
*   Заполните поля с именем пользователя, паролем, полным именем и email-адресом.
*   Эти данные будут использоваться для входа в систему в дальнейшем.

**4. Настройка URL-адреса Jenkins:**

*   На следующем экране Jenkins попросит подтвердить или изменить URL-адрес, по которому будет доступен сервер.
*   Этот URL важен для правильной работы уведомлений и интеграций.

**5. Настройка глобальных инструментов:**

*   После завершения базовой настройки рекомендуется настроить глобальные инструменты, такие как JDK и Maven.
*   Перейдите в **"Manage Jenkins" > "Global Tool Configuration"** и добавьте необходимые инструменты.

**6. Настройка безопасности:**

*   В разделе **"Manage Jenkins" > "Configure Global Security"** настройте параметры безопасности, включая стратегию авторизации и аутентификации.

**7. Настройка системных параметров:**

*   В **"Manage Jenkins" > "Configure System"** можно настроить глобальные параметры Jenkins, такие как количество исполнителей, путь к JDK, настройки почты и другие системные параметры.

**8. Установка дополнительных плагинов:**

*   Если требуются дополнительные функции, перейдите в **"Manage Jenkins" > "Manage Plugins"** и установите необходимые плагины.

**9. Настройка резервного копирования:**

*   Рекомендуется настроить регулярное резервное копирование директории `JENKINS_HOME` для сохранения конфигураций и данных.

**10. Проверка и тестирование:**

*   После завершения настройки создайте тестовое задание (job) для проверки работоспособности Jenkins.

Выполнив эти шаги, вы получите полностью настроенный экземпляр Jenkins, готовый к использованию в вашем CI/CD процессе. Помните, что конкретные настройки могут варьироваться в зависимости от требований вашего проекта и инфраструктуры.

## Популярные плагины Jenkins

Jenkins обладает обширной экосистемой плагинов, которые расширяют его функциональность и позволяют адаптировать инструмент под различные потребности разработки и развертывания. Вот список наиболее востребованных плагинов Jenkins:

1. **Git Plugin:** Обеспечивает интеграцию с системой контроля версий Git, позволяя Jenkins взаимодействовать с Git-репозиториями.
2. **Pipeline:** Позволяет создавать сложные рабочие процессы CI/CD в виде кода, что упрощает управление и версионирование конфигураций сборки.
3. **Docker Plugin:** Предоставляет возможность управлять Docker-контейнерами непосредственно из Jenkins, что полезно для создания изолированных сред сборки и тестирования.
4. **Blue Ocean:** Улучшает пользовательский интерфейс Jenkins, предоставляя более современный и интуитивно понятный способ визуализации и управления пайплайнами.
5. **Credentials Plugin:** Позволяет безопасно хранить и управлять учетными данными, такими как пароли, ключи SSH и токены API, необходимыми для различных интеграций.
6. **JIRA Plugin:** Интегрирует Jenkins с системой управления задачами JIRA, позволяя автоматически обновлять статусы задач и связывать сборки с соответствующими тикетами.
7. **Build Failure Analyzer:** Помогает определять причины неудачных сборок, анализируя логи и предоставляя рекомендации по устранению проблем.
8. **Role-based Authorization Strategy:** Обеспечивает гибкое управление доступом на основе ролей, что особенно важно для больших команд и организаций.
9. **GitHub Pull Request Builder:** Автоматизирует процесс проверки и тестирования pull-запросов в GitHub, интегрируя его с процессом CI/CD.
10. **Periodic Backup:** Позволяет настроить регулярное резервное копирование конфигураций Jenkins, что критично для восстановления системы в случае сбоев.
11. **Folders Plugin:** Помогает организовать и структурировать задания Jenkins в иерархию папок, что упрощает управление большим количеством проектов.
12. **Performance Plugin:** Позволяет отслеживать и анализировать показатели производительности сборок и тестов.

Эти плагины значительно расширяют возможности Jenkins, позволяя адаптировать его под специфические требования различных проектов и рабочих процессов. При выборе плагинов важно учитывать конкретные потребности вашего проекта и инфраструктуры, а также регулярно обновлять плагины для обеспечения безопасности и стабильности работы Jenkins.
